# Как отсортировать данные

Данные проще анализировать в отсортированном виде. Сортировка позволяет выгрузить «топ» определённых значений, поэтому отсортированная таблица нагляднее.

В SQL можно отсортировать значения по полям с данными любого типа. Поля с числовыми типами данных сортируют по возрастанию или убыванию. Так же можно сортировать даты и время. А поля с символами сортируют в алфавитном порядке и наоборот.

## Оператор `ORDER BY`

Для сортировки данных в SQL используют оператор `ORDER BY`. Его пишут в самом конце запроса, после него можно указать только операторы `LIMIT` и `OFFSET`.

Разберём синтаксис оператора `ORDER BY` на примере. В прошлом уроке вы выгружали таблицу со средним возрастом клиентов по зоне подключения. Запрос вернул такой результат:

Скопировать код

SQL

```
SELECT connection_area,
       AVG(age)
FROM buyer
WHERE company_marker = 0
GROUP BY connection_area; 
```

Чтобы определить, в какой зоне подключаются клиенты самого большого среднего возраста, придётся на глаз сравнивать значения. В выдаче шесть записей — не очень много, но таблица станет понятнее, если данные отсортировать.

Скопировать код

SQL

```
SELECT connection_area,
       AVG(age)
FROM buyer
WHERE company_marker = 0
GROUP BY connection_area
ORDER BY AVG(age); 
```

## Как изменить порядок сортировки

По умолчанию оператор `ORDER BY` сортирует данные от меньшего к большему. Чтобы изменить порядок сортировки, после названия поля указывают ключевое слово `DESC`: тогда данные будут отсортированы по убыванию. Если указать `ASC`, данные будут отсортированы по возрастанию — так же, как и по умолчанию.

Теперь можно составить топ зон по значению среднего возраста. В таблицу войдут название зоны и средний возраст, отсортированные от старшего к младшему. Запрос выведет первые пять записей.

Скопировать код

SQL

```
SELECT connection_area,
       AVG(age)
FROM buyer
WHERE company_marker = 0
GROUP BY connection_area
ORDER BY AVG(age) DESC
LIMIT 5; 
```

В запрос можно добавить псевдоним, чтобы не указывать агрегирующую функцию в запросе дважды:

Скопировать код

SQL

```
SELECT connection_area,
       AVG(age) AS average_age
FROM buyer
WHERE company_marker = 0
GROUP BY connection_area
ORDER BY average_age DESC
LIMIT 5; 
```
## Как составить рейтинг

Комбинации сортировок, группировок и фильтраций — это прекрасный инструмент для создания рейтингов. Например, менеджер просит составить топ-3 самых продаваемых хот-догов. Решают эту задачу так:

1. Сначала агрегируем и группируем данные.
2. Сортируем результат по убыванию.
3. Ограничиваем выгрузку тремя строками.

Получаем запрос:

Скопировать код

SQL

```
SELECT name_hotdog,
       COUNT(name_hotdog) AS cnt_hotdog
FROM hotdog
GROUP BY name_hotdog -- 1) группировка
ORDER BY cnt_hotdog DESC -- 2) сортировка
LIMIT 3; -- 3) ограничение 
```
